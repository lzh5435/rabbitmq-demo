package test.liuzehua.rabbitmqdemo.topic;import com.rabbitmq.client.*;import test.liuzehua.rabbitmqdemo.utils.ConnectionFactoryUtil;import java.io.IOException;/** * @author liuzehua * 2020/6/6 **/public class Consumer2 {    public static void main(String[] args) throws IOException {        Connection connection = ConnectionFactoryUtil.getConnection();        Channel channel = connection.createChannel();        // 1，交换机名称  2，交换机类型  topic  不同消费者消费不同消息   动态路由匹配        channel.exchangeDeclare("topics","topic");        //创建临时队列        String queue = channel.queueDeclare().getQueue();        // 绑定交换机和队列 路由key        //  可以绑定多个key        channel.queueBind(queue,"topics","*.mq");        channel.basicQos(1);        //消费        channel.basicConsume(queue,false,new DefaultConsumer(channel){            @Override            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {                System.out.println("consumer22 消费信息 topic类型信息：：： "+new String(body));                channel.basicAck(envelope.getDeliveryTag(),false);            }        });    }}